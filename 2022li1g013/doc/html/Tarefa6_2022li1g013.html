<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa6_2022li1g013</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Lu&#237;s Cunha &lt;a104613@alunos.uminho.pt&gt;<br />Tom&#225;s Barbosa &lt;a104532@alunos.uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Tarefa6_2022li1g013</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>M&#243;dulo para a realiza&#231;&#227;o da Tarefa 6 do projeto de LI1 2022/23.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Opcao">Opcao</a><ul class="subs"><li>= <a href="#v:Jogar">Jogar</a></li><li>| <a href="#v:Sair">Sair</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Menu">Menu</a><ul class="subs"><li>= <a href="#v:Opcoes">Opcoes</a> <a href="Tarefa6_2022li1g013.html#t:Opcao" title="Tarefa6_2022li1g013">Opcao</a></li><li>| <a href="#v:ModoJogo">ModoJogo</a></li><li>| <a href="#v:PerdeuJogo">PerdeuJogo</a> <a href="Tarefa6_2022li1g013.html#t:Opcao" title="Tarefa6_2022li1g013">Opcao</a></li></ul></li><li class="src short"><span class="keyword">data</span> <a href="#t:Tile">Tile</a><ul class="subs"><li>= <a href="#v:RioT">RioT</a></li><li>| <a href="#v:RelvaT">RelvaT</a></li><li>| <a href="#v:EstradaT">EstradaT</a></li><li>| <a href="#v:Carro1T">Carro1T</a></li><li>| <a href="#v:Carro2T">Carro2T</a></li><li>| <a href="#v:ArvoreT">ArvoreT</a></li><li>| <a href="#v:Tronco1T">Tronco1T</a></li><li>| <a href="#v:Tronco2T">Tronco2T</a></li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:Numeros">Numeros</a> = [Int]</li><li class="src short"><span class="keyword">type</span> <a href="#t:Score">Score</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Saux">Saux</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Naux">Naux</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Images">Images</a> = [Picture]</li><li class="src short"><span class="keyword">data</span> <a href="#t:World">World</a> = <a href="#v:World">World</a> {<ul class="subs"><li><a href="#v:menu">menu</a> :: <a href="Tarefa6_2022li1g013.html#t:Menu" title="Tarefa6_2022li1g013">Menu</a></li><li><a href="#v:numeros">numeros</a> :: <a href="Tarefa6_2022li1g013.html#t:Numeros" title="Tarefa6_2022li1g013">Numeros</a></li><li><a href="#v:jogo">jogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></li><li><a href="#v:score">score</a> :: <a href="Tarefa6_2022li1g013.html#t:Score" title="Tarefa6_2022li1g013">Score</a></li><li><a href="#v:saux">saux</a> :: <a href="Tarefa6_2022li1g013.html#t:Saux" title="Tarefa6_2022li1g013">Saux</a></li><li><a href="#v:naux">naux</a> :: <a href="Tarefa6_2022li1g013.html#t:Naux" title="Tarefa6_2022li1g013">Naux</a></li><li><a href="#v:images">images</a> :: <a href="Tarefa6_2022li1g013.html#t:Images" title="Tarefa6_2022li1g013">Images</a></li></ul>}</li><li class="src short"><a href="#v:initialState">initialState</a> :: <a href="Tarefa6_2022li1g013.html#t:Images" title="Tarefa6_2022li1g013">Images</a> -&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></li><li class="src short"><a href="#v:drawState">drawState</a> :: <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a> -&gt; Picture</li><li class="src short"><a href="#v:drawScore">drawScore</a> :: String -&gt; Picture</li><li class="src short"><a href="#v:showScore">showScore</a> :: Int -&gt; Picture</li><li class="src short"><a href="#v:event">event</a> :: Event -&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a> -&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></li><li class="src short"><a href="#v:time">time</a> :: Float -&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a> -&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></li><li class="src short"><a href="#v:criarmapa">criarmapa</a> :: Int -&gt; Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; Int -&gt; Int -&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</li><li class="src short"><a href="#v:mapatotilelist">mapatotilelist</a> :: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])] -&gt; [[<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>]]</li><li class="src short"><a href="#v:obstaculototile">obstaculototile</a> :: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>]) -&gt; [<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>]</li><li class="src short"><a href="#v:drawTile">drawTile</a> :: Float -&gt; <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a> -&gt; [Picture] -&gt; Picture</li><li class="src short"><a href="#v:drawList">drawList</a> :: Float -&gt; [<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>] -&gt; [Picture] -&gt; Picture</li><li class="src short"><a href="#v:drawGrid">drawGrid</a> :: Float -&gt; [[<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>]] -&gt; [Picture] -&gt; Picture</li><li class="src short"><a href="#v:window">window</a> :: Display</li><li class="src short"><a href="#v:background">background</a> :: Color</li><li class="src short"><a href="#v:fr">fr</a> :: Int</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Opcao" class="def">Opcao</a> <a href="#t:Opcao" class="selflink">#</a></p><div class="doc"><p>Valor que diferencia se se quer Jogar ou Sair</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Jogar" class="def">Jogar</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Sair" class="def">Sair</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Menu" class="def">Menu</a> <a href="#t:Menu" class="selflink">#</a></p><div class="doc"><p>Diferentes Menus do jogo</p><p>O Menu Opcoes &#233; o que aparece quando se entra no jogo, o Menu ModoJogo &#233; o menu quando se est&#225; a jogar e o Menu PerdeuJogo &#233; o Menu de quando se perde o jogo</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Opcoes" class="def">Opcoes</a> <a href="Tarefa6_2022li1g013.html#t:Opcao" title="Tarefa6_2022li1g013">Opcao</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ModoJogo" class="def">ModoJogo</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:PerdeuJogo" class="def">PerdeuJogo</a> <a href="Tarefa6_2022li1g013.html#t:Opcao" title="Tarefa6_2022li1g013">Opcao</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Tile" class="def">Tile</a> <a href="#t:Tile" class="selflink">#</a></p><div class="doc"><p>Diferentes superf&#237;cies do jogo</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:RioT" class="def">RioT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:RelvaT" class="def">RelvaT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:EstradaT" class="def">EstradaT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Carro1T" class="def">Carro1T</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Carro2T" class="def">Carro2T</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ArvoreT" class="def">ArvoreT</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Tronco1T" class="def">Tronco1T</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Tronco2T" class="def">Tronco2T</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Tile">Instances</h4><details id="i:Tile" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Tile:Eq:1"></span> Eq <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a></span> <a href="#t:Tile" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Tile:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Tarefa6_2022li1g013.html">Tarefa6_2022li1g013</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a> -&gt; <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a> -&gt; <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Tile:Show:2"></span> Show <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a></span> <a href="#t:Tile" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Tile:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Tarefa6_2022li1g013.html">Tarefa6_2022li1g013</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Numeros" class="def">Numeros</a> = [Int] <a href="#t:Numeros" class="selflink">#</a></p><div class="doc"><p>Lista de n&#250;meros usados para a aleatoriedade do jogo</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Score" class="def">Score</a> = Int <a href="#t:Score" class="selflink">#</a></p><div class="doc"><p>Score do jogo que aumenta 1 ponto sempre que o jogador avan&#231;a uma linha nova do mapa</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Saux" class="def">Saux</a> = Int <a href="#t:Saux" class="selflink">#</a></p><div class="doc"><p>N&#250;mero auxiliar para o funcionamento correto do Score</p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Naux" class="def">Naux</a> = Int <a href="#t:Naux" class="selflink">#</a></p><div class="doc"><p>N&#250;mero auxiliar para a fun&#231;&#227;o <code><a href="Tarefa6_2022li1g013.html#v:time" title="Tarefa6_2022li1g013">time</a></code></p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Images" class="def">Images</a> = [Picture] <a href="#t:Images" class="selflink">#</a></p><div class="doc"><p>Lista de imagens importadas</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:World" class="def">World</a> <a href="#t:World" class="selflink">#</a></p><div class="doc"><p>Conjunto de todas as outras vari&#225;veis que forma a vari&#225;vel conjunta World</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:World" class="def">World</a></td><td class="doc"><p>Conjunto das imagens importadas</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:menu" class="def">menu</a> :: <a href="Tarefa6_2022li1g013.html#t:Menu" title="Tarefa6_2022li1g013">Menu</a></dfn><div class="doc"><p>Menu atual do jogo</p></div></li><li><dfn class="src"><a id="v:numeros" class="def">numeros</a> :: <a href="Tarefa6_2022li1g013.html#t:Numeros" title="Tarefa6_2022li1g013">Numeros</a></dfn><div class="doc"><p>Lista de n&#250;meros usada para a eleatoriedade do jogo</p></div></li><li><dfn class="src"><a id="v:jogo" class="def">jogo</a> :: <a href="LI12223.html#t:Jogo" title="LI12223">Jogo</a></dfn><div class="doc"><p>Jogo</p></div></li><li><dfn class="src"><a id="v:score" class="def">score</a> :: <a href="Tarefa6_2022li1g013.html#t:Score" title="Tarefa6_2022li1g013">Score</a></dfn><div class="doc"><p>Score do Jogo</p></div></li><li><dfn class="src"><a id="v:saux" class="def">saux</a> :: <a href="Tarefa6_2022li1g013.html#t:Saux" title="Tarefa6_2022li1g013">Saux</a></dfn><div class="doc"><p>Auxiliar para o Score funcionar </p></div></li><li><dfn class="src"><a id="v:naux" class="def">naux</a> :: <a href="Tarefa6_2022li1g013.html#t:Naux" title="Tarefa6_2022li1g013">Naux</a></dfn><div class="doc"><p>Auxiliar para a fun&#231;&#227;o Time</p></div></li><li><dfn class="src"><a id="v:images" class="def">images</a> :: <a href="Tarefa6_2022li1g013.html#t:Images" title="Tarefa6_2022li1g013">Images</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:initialState" class="def">initialState</a> <a href="#v:initialState" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Tarefa6_2022li1g013.html#t:Images" title="Tarefa6_2022li1g013">Images</a></td><td class="doc"><p>recebe Imagens</p></td></tr><tr><td class="src">-&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></td><td class="doc"><p>devolve um mundo do jogo</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>initialState</strong></code></em>  serve para definir o estado inicial do World</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>initialState images = (World (Opcoes Jogar) (drop 11 (randomRs (1, 100) (mkStdGen 2021))) (Jogo (Jogador (5,14)) (Mapa 11 (<code><a href="Tarefa6_2022li1g013.html#v:criarmapa" title="Tarefa6_2022li1g013">criarmapa</a></code> 11 15 [] (head (drop 11 (randomRs (1, 100) (mkStdGen 2021)))) 0))) 0 0 0 images)  
</pre></div></div><div class="top"><p class="src"><a id="v:drawState" class="def">drawState</a> <a href="#v:drawState" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></td><td class="doc"><p>recebe um mundo do jogo</p></td></tr><tr><td class="src">-&gt; Picture</td><td class="doc"><p>devolve a parte gr&#225;fica do jogo</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>drawState</strong></code></em>  serve para modificar o estado do World</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>drawState (World (PerdeuJogo Jogar) _ _ score _ _ images) = Pictures [Translate (-100) (100)$ Color red $ <code>drawOption</code> (&quot;Score: &quot;++(show score)) ,Translate (-200) 200 $ Color red $ Text <a href="Perdeu.html">Perdeu</a>, Translate 50 (-50) $ (images !! 11) , Translate 50 (-250) $ (images !! 10)]
drawState (World (PerdeuJogo Sair) _ _ score _ _ images) = Pictures [Translate (-100) (100)$ Color red $ <code>drawOption</code> (&quot;Score: &quot;++(show score)) ,Translate (-200) 200 $ Color red $ Text <a href="Perdeu.html">Perdeu</a>, Translate 50 (-50) $ (images !! 9), Color blue $ Translate 50 (-250) $ (images !! 12)]
drawState (World (Opcoes Jogar) _ _ _ _ _ images) = Pictures [Translate 50 50 $ (images !! 11), Translate 50 (-150) $ (images !! 10)]
drawState (World (Opcoes Sair) _ _ _ _ _ images) = Pictures [Translate 50 50 $ (images !! 9), Translate 50 (-150) $ (images !! 12)]
drawState (World ModoJogo numeros (Jogo (Jogador(x, y)) (Mapa l terr)) score _ _ images) = Pictures [(translate (-250) 375 (<code><a href="Tarefa6_2022li1g013.html#v:drawGrid" title="Tarefa6_2022li1g013">drawGrid</a></code> 50 (<code><a href="Tarefa6_2022li1g013.html#v:mapatotilelist" title="Tarefa6_2022li1g013">mapatotilelist</a></code> terr) images) ), (translate (-250) 375 (translate (fromIntegral(x*50)) (fromIntegral(y*(-50))) (images !! 8))), (translate 50 150 (<code><a href="Tarefa6_2022li1g013.html#v:showScore" title="Tarefa6_2022li1g013">showScore</a></code> score))]
</pre></div></div><div class="top"><p class="src"><a id="v:drawScore" class="def">drawScore</a> :: String -&gt; Picture <a href="#v:drawScore" class="selflink">#</a></p><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>drawScore</strong></code></em>  serve para escrever o Score no Menu PerdeuJogo</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>drawScore option = Translate (-50) 0 $ Scale (0.5) (0.5) $ Text option
</pre></div></div><div class="top"><p class="src"><a id="v:showScore" class="def">showScore</a> <a href="#v:showScore" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>recebe o score (n&#250;mero)</p></td></tr><tr><td class="src">-&gt; Picture</td><td class="doc"><p>devolve a imagem dos score no mapa</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>showScore</strong></code></em>  serve para desenhar o Score durante o jogo</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>showScore n = translate 150 150$ scale 0.2 0.2 $ color white $ Text (show n)
</pre></div></div><div class="top"><p class="src"><a id="v:event" class="def">event</a> <a href="#v:event" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Event</td><td class="doc"><p>recebe um evento (premir tecla)</p></td></tr><tr><td class="src">-&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></td><td class="doc"><p>recebe um mundo do jogo</p></td></tr><tr><td class="src">-&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></td><td class="doc"><p>devolve um mundo atualizado
Menu</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>event</strong></code></em>  serve modificar o estado do World conforme se v&#227;o premindo teclas</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>event (EventKey (SpecialKey KeyEnter) Down _ _) (World (Opcoes Jogar) numeros jogo score saux naux images) = (World ModoJogo numeros jogo score saux naux images)
event (EventKey (SpecialKey KeyUp) Down _ _) (World (Opcoes Jogar) numeros jogo score saux naux images)= (World (Opcoes Sair) numeros jogo score saux naux images) 
event (EventKey (SpecialKey KeyDown) Down _ _) (World (Opcoes Jogar) numeros jogo score saux naux images) = (World (Opcoes Sair) numeros jogo score saux naux images)
event (EventKey (SpecialKey KeyUp) Down _ _) (World (Opcoes Sair) numeros jogo score saux naux images) = (World (Opcoes Jogar)  numeros jogo score saux naux images)
event (EventKey (SpecialKey KeyDown) Down _ _) (World (Opcoes Sair) numeros jogo score saux naux images)  = (World (Opcoes Jogar) numeros jogo score saux naux images)
event (EventKey (SpecialKey KeyEnter) Down _ _) (World (Opcoes Sair) _ _ _ _ _ _) = error &quot;Fim de Jogo&quot;
event (EventKey (SpecialKey KeyUp) Down _ _) (World ModoJogo numeros j<code>(Jogo (Jogador (x,y)) (Mapa l terr)) score saux naux images) 
  | <code><a href="Tarefa4_2022li1g013.html#v:jogoTerminou" title="Tarefa4_2022li1g013">jogoTerminou</a></code> j == True = (World (PerdeuJogo Jogar) numeros j score saux naux images)
  | score == saux = (World ModoJogo numeros (<code><a href="Tarefa3_2022li1g013.html#v:animaJogador" title="Tarefa3_2022li1g013">animaJogador</a></code> j (Move Cima)) (score+1) (saux+1) naux images)
  | otherwise = (World ModoJogo numeros (<code><a href="Tarefa3_2022li1g013.html#v:animaJogador" title="Tarefa3_2022li1g013">animaJogador</a></code> j (Move Cima)) score (saux+1) naux images)
event (EventKey (SpecialKey KeyDown) Down _ _) (World ModoJogo numeros j</code>(Jogo (Jogador (x,y)) (Mapa l terr)) score saux naux images) 
  | <code><a href="Tarefa4_2022li1g013.html#v:jogoTerminou" title="Tarefa4_2022li1g013">jogoTerminou</a></code> j == True = (World (PerdeuJogo Jogar) numeros j score saux naux images)
  | otherwise = (World ModoJogo numeros (<code><a href="Tarefa3_2022li1g013.html#v:animaJogador" title="Tarefa3_2022li1g013">animaJogador</a></code> j (Move Baixo)) score (saux-1) naux images)
event (EventKey (SpecialKey KeyRight) Down _ _) (World ModoJogo numeros j<code>(Jogo (Jogador (x,y)) (Mapa l terr)) score saux naux images) 
  | <code><a href="Tarefa4_2022li1g013.html#v:jogoTerminou" title="Tarefa4_2022li1g013">jogoTerminou</a></code> j == True = (World (PerdeuJogo Jogar) numeros j score saux naux images)
  | otherwise = (World ModoJogo numeros (<code><a href="Tarefa3_2022li1g013.html#v:animaJogador" title="Tarefa3_2022li1g013">animaJogador</a></code> j (Move Direita)) score saux naux images)
event (EventKey (SpecialKey KeyLeft) Down _ _) (World ModoJogo numeros j</code>(Jogo (Jogador (x,y)) (Mapa l terr)) score saux naux images) 
  | <code><a href="Tarefa4_2022li1g013.html#v:jogoTerminou" title="Tarefa4_2022li1g013">jogoTerminou</a></code> j == True = (World (PerdeuJogo Jogar) numeros j score saux naux images)
  | otherwise = (World ModoJogo numeros (<code><a href="Tarefa3_2022li1g013.html#v:animaJogador" title="Tarefa3_2022li1g013">animaJogador</a></code> j (Move Esquerda)) score saux naux images)
event (EventKey (SpecialKey KeyUp) Down _ _) (World (PerdeuJogo Jogar) numeros jogo score saux naux images) = (World (PerdeuJogo Sair) numeros jogo score saux naux images)
event (EventKey (SpecialKey KeyDown) Down _ _) (World (PerdeuJogo Jogar) numeros jogo score saux naux images) = (World (PerdeuJogo Sair) numeros jogo score saux naux images)
event (EventKey (SpecialKey KeyUp) Down _ _) (World (PerdeuJogo Sair) numeros jogo score saux naux images) = (World (PerdeuJogo Jogar) numeros jogo score saux naux images)
event (EventKey (SpecialKey KeyDown) Down _ _) (World (PerdeuJogo Sair) numeros jogo score saux naux images) = (World (PerdeuJogo Jogar) numeros jogo score saux naux images)
event (EventKey (SpecialKey KeyEnter) Down _ _) (World (PerdeuJogo Jogar) numeros _ _ _ _ images) = (World ModoJogo (drop 10 numeros) (Jogo (Jogador (5,14)) (Mapa 11 (<code><a href="Tarefa6_2022li1g013.html#v:criarmapa" title="Tarefa6_2022li1g013">criarmapa</a></code> 11 15 [] (head (drop 10 numeros)) 0))) 0 0 0 images)
event (EventKey (SpecialKey KeyEnter) Down _ _) (World (PerdeuJogo Sair) _ _ _ _ _ _) = error &quot;Fim de Jogo&quot;
event _ world = world
</pre></div></div><div class="top"><p class="src"><a id="v:time" class="def">time</a> <a href="#v:time" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Float</td><td class="doc"><p>recebe um float</p></td></tr><tr><td class="src">-&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></td><td class="doc"><p>recebe um mundo do jogo</p></td></tr><tr><td class="src">-&gt; <a href="Tarefa6_2022li1g013.html#t:World" title="Tarefa6_2022li1g013">World</a></td><td class="doc"><p>devolve um mundo atualizado</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>time</strong></code></em>  serve para modificar o estado do World conforme o tempo passa e aumentar a dificuldade quando o score a ultrapassa os 25 e os 50 pontos</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>time n (World ModoJogo numeros j@(Jogo (Jogador (x,y)) (Mapa l terr)) score saux naux images) 
  | y == 16 &amp;&amp; <code><a href="Tarefa4_2022li1g013.html#v:jogoTerminou" title="Tarefa4_2022li1g013">jogoTerminou</a></code> (Jogo (Jogador (x,y)) (Mapa l (tail terr))) == True = (World (PerdeuJogo Jogar) numeros j score saux naux images)
  | <code><a href="Tarefa4_2022li1g013.html#v:jogoTerminou" title="Tarefa4_2022li1g013">jogoTerminou</a></code> j = (World (PerdeuJogo Jogar) numeros j score saux naux images)
  | score &lt;= 25 &amp;&amp; mod naux 20 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa3_2022li1g013.html#v:animaJogo" title="Tarefa3_2022li1g013">animaJogo</a></code> j Parado) score saux (naux+1) images)
  | score &lt;= 25 &amp;&amp; mod naux 30 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa5_2022li1g013.html#v:deslizaJogo" title="Tarefa5_2022li1g013">deslizaJogo</a></code> j (head numeros)) score saux (naux+1) images)
  | score &lt;= 25 &amp;&amp; mod naux 20 == 0 &amp;&amp; mod naux 30 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa5_2022li1g013.html#v:deslizaJogo" title="Tarefa5_2022li1g013">deslizaJogo</a></code> (<code><a href="Tarefa3_2022li1g013.html#v:animaJogo" title="Tarefa3_2022li1g013">animaJogo</a></code> j Parado) (head numeros)) score saux (naux+1) images)
  | score &gt; 25 &amp;&amp; score &lt;= 50 &amp;&amp; mod naux 15 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa3_2022li1g013.html#v:animaJogo" title="Tarefa3_2022li1g013">animaJogo</a></code> j Parado) score saux (naux+1) images)
  | score &gt; 25 &amp;&amp; score &lt;= 50 &amp;&amp; mod naux 25 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa5_2022li1g013.html#v:deslizaJogo" title="Tarefa5_2022li1g013">deslizaJogo</a></code> j (head numeros)) score saux (naux+1) images)
  | score &gt; 25 &amp;&amp; score &lt;= 50 &amp;&amp; mod naux 15 == 0 &amp;&amp; mod naux 25 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa5_2022li1g013.html#v:deslizaJogo" title="Tarefa5_2022li1g013">deslizaJogo</a></code> (<code><a href="Tarefa3_2022li1g013.html#v:animaJogo" title="Tarefa3_2022li1g013">animaJogo</a></code> j Parado) (head numeros)) score saux (naux+1) images)
  | score &gt; 50 &amp;&amp; mod naux 11 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa3_2022li1g013.html#v:animaJogo" title="Tarefa3_2022li1g013">animaJogo</a></code> j Parado) score saux (naux+1) images)
  | score &gt; 50 &amp;&amp; mod naux 21 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa5_2022li1g013.html#v:deslizaJogo" title="Tarefa5_2022li1g013">deslizaJogo</a></code> j (head numeros)) score saux (naux+1) images)
  | score &gt; 50 &amp;&amp; mod naux 11 == 0 &amp;&amp; mod naux 21 == 0 = (World ModoJogo (tail numeros) (<code><a href="Tarefa5_2022li1g013.html#v:deslizaJogo" title="Tarefa5_2022li1g013">deslizaJogo</a></code> (animaJogo j Parado) (head numeros)) score saux (naux+1) images)
  | otherwise = (World ModoJogo numeros j score saux (naux+1) images)
time _ w = w
</pre></div></div><div class="top"><p class="src"><a id="v:criarmapa" class="def">criarmapa</a> <a href="#v:criarmapa" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>recebe a largura do mapa</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>recebe a (altura do mapa-1)</p></td></tr><tr><td class="src">-&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>recebe uma lista de tuplos de terreno e lista de obst&#225;culos (inicialmente [])</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>recebe um n&#250;mero aleat&#243;rio</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>recebe um acumulador</p></td></tr><tr><td class="src">-&gt; [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>devolve uma lista de tuplos de terreno e lista de obst&#225;culos</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>criarmapa</strong></code></em>  serve para criar um Mapa para o Jogo</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>criarmapa larg h t n ac
  | ac == h = t
  | ac == 0 = (criarmapa larg h (<code><a href="Tarefa2_2022li1g013.html#v:estendeMapa-39-" title="Tarefa2_2022li1g013">estendeMapa'</a></code> larg t n) (n + (mod n 5)) (ac+4))++[(Relva,[Arvore,Arvore,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Arvore,Arvore]),(Relva,[Arvore,Arvore,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Arvore,Arvore]),(Relva,[Arvore,Arvore,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Arvore,Arvore]),(Relva,[Arvore,Arvore,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Arvore,Arvore]),(Relva,[Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum,Nenhum])]
  | ac &lt; h = criarmapa larg h (<code><a href="Tarefa2_2022li1g013.html#v:estendeMapa-39-" title="Tarefa2_2022li1g013">estendeMapa'</a></code> larg t n) (n + (mod n 5)) (ac+1)
</pre></div></div><div class="top"><p class="src"><a id="v:mapatotilelist" class="def">mapatotilelist</a> <a href="#v:mapatotilelist" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: [(<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])]</td><td class="doc"><p>recebe uma lista de tuplos de terreno e lista de obst&#225;culos</p></td></tr><tr><td class="src">-&gt; [[<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>]]</td><td class="doc"><p>devolve uma lista de listas de Tiles (imagens de terrenos/obst&#225;culos)</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>mapatotilelist</strong></code></em>  serve converter o Mapa numa lista de listas de Tile, sendo que cada lista de Tile corresponde a uma linha do Mapa</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>mapatotilelist [] = []
mapatotilelist ((Estrada v, obs):t) = <code><a href="Tarefa6_2022li1g013.html#v:obstaculototile" title="Tarefa6_2022li1g013">obstaculototile</a></code> (Estrada v, obs) : mapatotilelist t
mapatotilelist ((Rio v, obs):t) = <code><a href="Tarefa6_2022li1g013.html#v:obstaculototile" title="Tarefa6_2022li1g013">obstaculototile</a></code> (Rio v, obs) : mapatotilelist t
mapatotilelist ((Relva, obs):t) = <code><a href="Tarefa6_2022li1g013.html#v:obstaculototile" title="Tarefa6_2022li1g013">obstaculototile</a></code> (Relva, obs) : mapatotilelist t
</pre></div></div><div class="top"><p class="src"><a id="v:obstaculototile" class="def">obstaculototile</a> <a href="#v:obstaculototile" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="LI12223.html#t:Terreno" title="LI12223">Terreno</a>, [<a href="LI12223.html#t:Obstaculo" title="LI12223">Obstaculo</a>])</td><td class="doc"><p>recebe um tuplo de terreno e lista de ibst&#225;culos</p></td></tr><tr><td class="src">-&gt; [<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>]</td><td class="doc"><p>devolve uma lista de Tiles (imagens de terrenos/obst&#225;culos))</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>obstaculototile</strong></code></em>  serve converter uma lista de obst&#225;culos em uma lista de Tile</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>obstaculototile (Estrada v, (h:t)) 
  | h == Nenhum = EstradaT : obstaculototile (Estrada v, t) 
  | v &gt; 0 &amp;&amp; h == Carro = Carro1T : obstaculototile (Estrada v, t)
  | v &lt; 0 &amp;&amp; h == Carro = Carro2T : obstaculototile (Estrada v, t) 
obstaculototile (Rio v, (h:t)) 
  | h == Nenhum = RioT : obstaculototile (Rio v, t) 
  | v &gt; 0 &amp;&amp; h == Tronco = Tronco1T : obstaculototile (Rio v, t)
  | v &lt; 0 &amp;&amp; h == Tronco = Tronco2T : obstaculototile (Rio v, t)  
obstaculototile (Relva , (h:t)) 
  | h == Nenhum = RelvaT : obstaculototile (Relva, t) 
  | h == Arvore = ArvoreT : obstaculototile (Relva , t) 
obstaculototile _ = []
</pre></div></div><div class="top"><p class="src"><a id="v:drawTile" class="def">drawTile</a> <a href="#v:drawTile" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Float</td><td class="doc"><p>recebe o comprimento do lado de Tile (pixeis)</p></td></tr><tr><td class="src">-&gt; <a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a></td><td class="doc"><p>recebe um Tile (imagem de terreno/obst&#225;culo)</p></td></tr><tr><td class="src">-&gt; [Picture]</td><td class="doc"><p>recebe a lista de imagens importadas</p></td></tr><tr><td class="src">-&gt; Picture</td><td class="doc"><p>devolve uma imagem</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>drawTile</strong></code></em>  serve converter um Tile numa imagem</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>drawTile side RioT p = p !! 0
drawTile side EstradaT p = p !! 1
drawTile side RelvaT p = p !! 2
drawTile side Tronco1T p = p !! 3
drawTile side Tronco2T p = p !! 4
drawTile side Carro1T p = p !! 5
drawTile side Carro2T p = p !! 6
drawTile side ArvoreT p = p !! 7
</pre></div></div><div class="top"><p class="src"><a id="v:drawList" class="def">drawList</a> <a href="#v:drawList" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Float</td><td class="doc"><p>recebe o comprimento do lado de Tile (pixeis)</p></td></tr><tr><td class="src">-&gt; [<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>]</td><td class="doc"><p>recebe uma lista de Tiles (imagens de terrenos/obst&#225;culos))</p></td></tr><tr><td class="src">-&gt; [Picture]</td><td class="doc"><p>recebe uma lista de Imagens</p></td></tr><tr><td class="src">-&gt; Picture</td><td class="doc"><p>devolve a imagem de uma linha do mapa</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>drawList</strong></code></em>  serve converter uma lista de Tile numa lista de imagens</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>drawList side [] p = Blank
drawList side (h:t) p = Pictures [desenhaTile, resto]
    where desenhaTile = <code><a href="Tarefa6_2022li1g013.html#v:drawTile" title="Tarefa6_2022li1g013">drawTile</a></code> side h p
          resto = Translate side 0 $ drawList side t p
</pre></div></div><div class="top"><p class="src"><a id="v:drawGrid" class="def">drawGrid</a> <a href="#v:drawGrid" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Float</td><td class="doc"><p>recebe o comprimento do lado de Tile (pixeis) </p></td></tr><tr><td class="src">-&gt; [[<a href="Tarefa6_2022li1g013.html#t:Tile" title="Tarefa6_2022li1g013">Tile</a>]]</td><td class="doc"><p>recebe uma lista de listas de Tiles (imagens de terrenos/obst&#225;culos)</p></td></tr><tr><td class="src">-&gt; [Picture]</td><td class="doc"><p>recebe uma lista de Imagens</p></td></tr><tr><td class="src">-&gt; Picture</td><td class="doc"><p>devolve a imagem do mapa completo</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>drawGrid</strong></code></em>  serve converter uma lista de listas de Tile numa lista de listas de imagens</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>drawGrid side [] p = Blank
drawGrid side (h:t) p = Pictures [desenhaLinha, resto]
    where desenhaLinha = <code><a href="Tarefa6_2022li1g013.html#v:drawList" title="Tarefa6_2022li1g013">drawList</a></code> side h p
          resto = Translate 0 (-side) $ drawGrid side t p
</pre></div></div><div class="top"><p class="src"><a id="v:window" class="def">window</a> <a href="#v:window" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Display</td><td class="doc"><p>janela do jogo</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>window</strong></code></em>  serve definir a janela do jogo</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>window = InWindow <a href="Janela.html">Janela</a> (550,800) (0,0)
</pre></div></div><div class="top"><p class="src"><a id="v:background" class="def">background</a> <a href="#v:background" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Color</td><td class="doc"><p>cor do background do jogo</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>background</strong></code></em>  serve definir a cor de fundo do jogo</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>background = (makeColorI 221 212 179 255)
</pre></div></div><div class="top"><p class="src"><a id="v:fr" class="def">fr</a> <a href="#v:fr" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>frame rate do jogo</p></td></tr></table></div><div class="doc"><p>A fun&#231;&#227;o <em><code><strong>fr</strong></code></em>  serve definir o frame rate do jogo</p><p>A fun&#231;&#227;o pode ser definida da seguinte forma : </p><pre>fr = 20
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>